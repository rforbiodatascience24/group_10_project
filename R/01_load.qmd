---
title: "01_load"
format: html
editor: visual
---

## Loading the raw data

```{r}
#Loading libraries
rm(list=ls())
library(here)
library(httr)
library(readr)
```

```{r}
raw_dir <- here("_raw/")
data_dir <- here("data/")

if (!dir.exists(raw_dir)) {
  dir.create(path = raw_dir)
  message("Created directory: ", raw_dir)
}

if (!dir.exists(data_dir)) {
  dir.create(path = data_dir)
  message("Created directory: ", data_dir)
}

url <- "https://www.kaggle.com/api/v1/datasets/download/aadyasingh55/drug-dataset"
temp_zip <- tempfile(fileext = ".zip")   
temp_dir <- tempdir()  

response <- GET(url, write_disk(temp_zip, overwrite = TRUE))

unzip(temp_zip, exdir = temp_dir)

extracted_files <- list.files(temp_dir, full.names = TRUE)
message("Extracted files: ", paste(extracted_files, collapse = ", "))

csv_file <- grep("\\.csv$", extracted_files, value = TRUE)

dataset <- read_csv(csv_file[1])

target_file <- file.path(raw_dir, basename(csv_file[1]))
  
file.rename(csv_file[1], target_file)


```
