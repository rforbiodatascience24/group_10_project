---
title: "05_analysis_1"
format: html
editor: visual
---

## Analysis of

```{r}
rm(list=ls())
library(tidyverse)
```

This analysis aims to investigate the reasons behind the excellent and poor reviews for the cancer drugs. This can be done by looking into the number and type of side effects, as it is probable that this will have an influence on the reviews. Firstly, the cancer data is loaded.

```{r, warning=FALSE}
#| message: false

# Loading the augmented data tsv file 
cancer_data <- read_tsv(here('data/03_dat_aug.tsv'))

```

The three review levels are shown in three scatter plots comparing number of side effects (x-axis) and the review percentages (y-axis).

```{r}

cancer_data |> 
  mutate(Review_level = factor(Review_level,   #Deciding the order appearing
                               levels = c("Poor_Review_%", 
                                          "Average_Review_%", 
                                          "Excellent_Review_%"))) |> 
  ggplot(aes(x = Count_Side_Effects,
             y = `Review_%`,
             fill = Review_level)) +
  geom_point(shape = 21, size = 3, color = "black") + 
  labs(x = "Count of Side Effects", 
       y = "Review Percentage", 
       title = "Number of Side Effects vs Review Percentage by Review Level") +
  theme_minimal() +
  facet_wrap(~ Review_level,
             labeller = as_labeller(c("Poor_Review_%" = "Poor Review", 
                                      "Average_Review_%" = "Average Review", 
                                      "Excellent_Review_%" = "Excellent Review"))) +     
  scale_fill_manual(values = c("Poor_Review_%" = "#F8766D",
                                "Average_Review_%" = "#619CFF",
                                "Excellent_Review_%" = "#00BA38")) +
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        legend.position = "none") 


```

From this plot we do not see a tendency of drugs with fewer side effects having a better review classification or vice versa. However, the correlation could perhaps be found by looking at the distribution of (lidt i tvivl om overgangen her..., vi sagde noget smart i g√•r).

```{r}
boxplot_administration_type <- cancer_data |> 
  mutate(Review_level = factor(Review_level,   #Deciding the order appearing
                               levels = c("Poor_Review_%", 
                                          "Average_Review_%", 
                                          "Excellent_Review_%"))) |>
  ggplot(aes(x = Administration_type, 
             y = `Review_%`, 
             fill = Review_level)) +
  geom_boxplot(alpha = 0.7) +
  theme_minimal() +
  labs(x = "Administration Type", 
       y = "Review Percentage", 
       title = str_wrap("Review Percentage of Administration Types by Review Level",55),
       fill = "Review Level") +
  scale_fill_manual(values = c("Poor_Review_%" = "#F8766D",
                               "Average_Review_%" = "#619CFF",
                               "Excellent_Review_%" = "#00BA38"),
                    labels = c("Poor", 
                               "Average", 
                               "Excellent")) +
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        axis.text.x = element_text(angle = 45, 
                                   hjust = 1),
        legend.position = "bottom")

ggsave(here("results/boxplot_administration_type.png"), plot = boxplot_administration_type, width = 6, height = 4)

```
