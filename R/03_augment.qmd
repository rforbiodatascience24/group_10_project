---
title: "03_augment"
format: html
editor: visual
---

## Loading libraries and files

### Loading libraries

```{r}
library(tidyverse)
library(dplyr)
library(readr)
```

### Loading clean file

```{r}
dir_load <- here("/data")
file_path <- file.path(dir_load, "02_dat_clean.tsv")

# Loading the clean data tsv file
write.tsv(clean_data, file_path, row.names = FALSE)
```

```{r}
# defining the augment (this shoudl be done when loading )
clean_data <- clean_data
```

## Augmentation of data

#### Augmenting data by adding count variables for 'Side_Effects', 'API' and 'Application'.

It is of interest how many side effects each person has experienced for the different drugs, in order to investigate whether some drugs might carry a higher amount than others, as well as certain combination of drugs. Therefore, a new variables is made, counting the amount of side effects and API for each observation. Furthermore, the count of application is made into a new variables as well, for each observation.

```{r}
aug_clean_data <- clean_data |>
  
  # Counting for each row, as nr. of side effects might differ
  rowwise() |>
  
  # mutating in order to make SE_count variable with sum of Column containing SE in         header as this refer to side       effects listed for each row 
  mutate(Side_Effects_count = sum(!is.na(c_across(contains("Side_Effects_")))), 
         API_count = sum(!is.na(c_across(contains("name_API_")))),
         Application_count = sum(!is.na(c_across(contains("Application_")))))

          
```

## Saving augmented cleaned data

```{r}
dir_save <- here("/data")
save_path <- file.path(dir_save, "03_dat_aug.tsv")

# Save the augmented data as a TSV file
write_tsv(aug_clean_data, save_path)
```
